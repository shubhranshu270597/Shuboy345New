<!--
  @description       : 
  @author            : shubhranshu
  @group             : 
  @last modified on  : 05-11-2021
  @last modified by  : shubhranshu
  Modifications Log 
  Ver   Date         Author        Modification
  1.0   07-04-2020   shubhranshu   Initial Version
-->
<aura:component controller="tripPandaController" implements="flexipage:availableForAllPageTypes" access="global">
    <ltng:require scripts="{!$Resource.sharethis}" afterScriptsLoaded="{!c.afterScriptsLoaded}" />
    <aura:attribute name="parameters" type="SObject"></aura:attribute>
    <aura:attribute name="ImageName" type="Object[]" />
    <aura:attribute name="ImageHeader" type="Object[]" />
    <aura:attribute name="ImageAltText" type="Object[]" />
    <aura:attribute name="tpConfigFound" type="Boolean" default="false"/>
    <aura:attribute name="tpConfig" type="SObject"></aura:attribute>
    <aura:attribute name="tpUserConfig" type="SObject[]"></aura:attribute>
    <aura:attribute name="tpUserConfigFound" type="Boolean" default="false" />
    <aura:attribute name="storyTimeline" type="SObject[]"></aura:attribute>
    <aura:attribute name="reimbursementRecords" type="SObject[]"></aura:attribute>
    <aura:attribute name="reimbursementraiseRecords" type="SObject[]"></aura:attribute>
    <aura:attribute name="reimbursementPaymentsRecords" type="SObject[]"></aura:attribute>
    <aura:attribute name="storyTimelineFound" type="Boolean" default="false" />
    <aura:attribute name="reimbursementFound" type="Boolean" default="false" />
    <aura:attribute name="reimbursementraiseFound" type="Boolean" default="false" />
    <aura:attribute name="tpUser" type="SObject"></aura:attribute>
    <aura:attribute name="errorMsg" type="String" />
    <aura:attribute name="errorFound" type="Boolean" default="false" />
    <aura:attribute name="successMsg" type="String" />
    <aura:attribute name="successFound" type="Boolean" default="false" />
    <aura:attribute name="warningMsg" type="String" />
    <aura:attribute name="warningFound" type="Boolean" default="false" />
    <aura:attribute name="TpCongId" type="String" />
    <aura:attribute name="LoginPageName" type="String" />
    <aura:attribute name="comments" type="String" />
    <aura:attribute name="addCommentShow" type="Boolean" />
    <aura:attribute name="sharethis" type="Boolean" default="false"/>
    <aura:attribute name="options" type="List" default="[
                    {'label': 'Food Expenses', 'value': 'Food Expenses'},
                    {'label': 'Travel Expenses', 'value': 'Travel Expenses'},
                    {'label': 'Hotel Expenses', 'value': 'Hotel Expenses'},
                    {'label': 'Shopping Expenses', 'value': 'Shopping Expenses'},
                    {'label': 'Others', 'value': 'Others'},
                    ]" />
    <aura:attribute name="tpusers" type="List" default="[
                        {'label': 'Choose TripPanda User', 'value': ''}]" />
    <aura:attribute name="reimbursement" type="Reimbursement__c" default="{'sobjectType':'Reimbursement__c',
                    'Amount__c':'','Description__c':'','Email__c':'','Other_Type__c':'','Reimbursement_name__c':'','Reimbursement_requested_by__c':'',
                    'Reimbursement_type__c':'','TripPandaMemberName__c':'','TripPandaUser__c':'','User_Email__c':''}" /> 
    <aura:attribute name="selectedtpusers" type="List"/>
    <aura:attribute name="reimbursementList" type="Reimbursement__c[]"/>
    <aura:attribute name="reOtherType" type="Boolean" default="false" />

    <aura:handler name="init" value="{!this}" action="{!c.doInit}" />

    <aura:if isTrue="{!v.errorFound}">
        <c:MessageComponent errorFound="true" errorMsg="{!v.errorMsg}"></c:MessageComponent>
    </aura:if>
    <aura:if isTrue="{!v.successFound}">
        <c:MessageComponent successFound="true" successMsg="{!v.successMsg}" ></c:MessageComponent>
    </aura:if>
    <aura:if isTrue="{!v.warningFound}">
        <c:MessageComponent warningFound="true" warningMsg="{!v.warningMsg}"></c:MessageComponent>
    </aura:if>
   
    <div class="slds-grid slds-wrap">
        <div class="slds-col slds-large-size_12-of-12">
            <header class="slds-global-header_container">
                <div class="slds-global-header slds-grid slds-grid_align-spread slds-var-p-horizontal_large headerPage">
                    <div class="slds-global-header__item">
                        <div class="slds-global-header__logo"></div>
                    </div>
                    <div class="slds-global-header__item">
                        <!-- <div class="slds-text-heading_medium">Kedarnath Trip</div> -->
                        <h2 class="slds-card__header-title">
                            <a href="javascript:void(0);" class="slds-card__header-link slds-truncate" title="{!v.tpConfig.Trip_Title__c}">
                                <span>{!v.tpConfig.Trip_Title__c}</span>
                            </a>
                            <lightning:button variant="base" iconName="utility:power" class="slds-var-m-left_x-small" onclick="{!c.SignOut}">
                            </lightning:button>
                        </h2>
                    </div>
                </div>
            </header>
            <article class="slds-card carouselComp">
                <div class="slds-card__body slds-grid">
                    <c:Make_Carousel_Comp lstImageName="{!v.ImageName}" lstImageAltText="{!v.ImageAltText}" lstImageHeader="{!v.ImageHeader}" aura:id="childComp"></c:Make_Carousel_Comp>
                </div>
            </article>
        </div>
    </div>
    <div class="slds-grid slds-wrap">
        <div class="slds-col slds-large-size_1-of-2 slds-medium-size_1-of-2 slds-size_1-of-1 slds-var-p-around_x-small">
            <center><div class="slds-text-heading_medium">Journey Members</div></center>
        </div>
        <div class="slds-col slds-large-size_1-of-2 slds-medium-size_1-of-2 slds-size_1-of-1 slds-var-p-around_x-small">
            <center><div class="slds-text-heading_medium">Quote's</div></center>
        </div>
    </div>
    <br />
    <aura:if isTrue="{!v.tpUserConfigFound}">
        <div class="slds-grid slds-wrap">
            <aura:iteration items="{!v.tpUserConfig}" var="tpusers">
                <div class="slds-col slds-large-size_1-of-2 slds-medium-size_1-of-2 slds-size_1-of-1 slds-var-p-around_x-small">
                    <!-- <center><div class="slds-text-heading_medium">Journey Members</div></center><br /> -->
                    <div class="demo-only slds-size_5-of-6">
                        <div class="slds-media slds-media_center">
                            <div class="slds-media__figure">
                                
                                <aura:if isTrue="{!tpusers.value.TripPandaUser__r.Profile_Image_Url__c != null}">
                                    <span class="slds-avatar slds-avatar_large">
                                        <a href="javascript:void(0);" data-value="{!tpusers.value.TripPandaUser__r.Id}" onclick="{!c.showProfileImageSection}">
                                            <lightning:avatar src="{!tpusers.value.TripPandaUser__r.Profile_Image_Url__c}" initials="BW"
                                                fallbackIconName="standard:person_account" alternativeText="{!tpusers.value.TripPandaUser__r.TP_Name__c}"/>
                                        </a>
                                    </span>
                                    <aura:if isTrue="{!tpusers.mouseover}">
                                        <section aria-describedby="dialog-body-id-98" aria-labelledby="dialog-heading-id-3"
                                            class="slds-popover slds-popover_walkthrough slds-nubbin_left" role="dialog">
                                            <a href="javascript:void(0);" data-value="{!tpusers.value.TripPandaUser__r.Id}" onclick="{!c.showProfileImageSection}">
                                                <lightning:icon class="slds-button slds-button_icon slds-button_icon-small slds-float_right slds-popover__close slds-button_icon-inverse"
                                                    iconName="utility:close" alternativeText="Close" title="Close" />
                                            </a>
                                            <div class="slds-popover__body" id="dialog-body-id-98">
                                                <img src="{!tpusers.value.TripPandaUser__r.Profile_Image_Url__c}" alt="profile Photo" />
                                            </div>
                                        </section>
                                    </aura:if>
                                </aura:if>
                                <aura:if isTrue="{!and(tpusers.value.TripPandaUser__r.Gender__c == 'Male', tpusers.value.TripPandaUser__r.Profile_Image_Url__c == null)}">
                                    <span class="slds-avatar slds-avatar_large">
                                        <lightning:avatar src="{!$Resource.SLDS+'/images/avatar1.jpg'}" initials="BW"
                                            fallbackIconName="standard:person_account" alternativeText="{!tpusers.value.TripPandaUser__r.TP_Name__c}" />
                                    </span>
                                </aura:if>
                                <aura:if isTrue="{!and(tpusers.value.TripPandaUser__r.Gender__c == 'Female', tpusers.value.TripPandaUser__r.Profile_Image_Url__c == null)}">
                                    <span class="slds-avatar slds-avatar_large">
                                        <lightning:avatar src="{!$Resource.SLDS+'/images/avatar2.jpg'}" initials="BW"
                                            fallbackIconName="standard:person_account" alternativeText="{!tpusers.value.TripPandaUser__r.TP_Name__c}" />
                                    </span>
                                </aura:if>
                            </div>
                            <div class="slds-media__body">
                                <p>{!tpusers.value.TripPandaUser__r.TP_Name__c}</p>
                                <p>{!tpusers.value.TripPandaUser__r.UserName__c}</p>
                                <p>{!tpusers.value.TripPandaUser__r.MobileNumber__c}</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="slds-col slds-large-size_1-of-2 slds-medium-size_1-of-2 slds-size_1-of-1 slds-p-around_x-small">
                    <!-- <center><div class="slds-text-heading_medium">Quote's</div></center><br /> -->
                    <p><i>{!tpusers.value.TripPandaUser__r.Quotes__c}</i></p>
                </div>
            </aura:iteration>
        </div>
    </aura:if>
    
    <!-- <div class="slds-col slds-large-size_1-of-2 slds-medium-size_1-of-2 slds-size_1-of-1 slds-p-around_x-small">
        <div class="slds-media slds-comment slds-hint-parent">
            <aura:if isTrue="{!v.tpUser.Gender__c == 'Male'}">
                <div class="slds-media__figure">
                    <a class="slds-avatar slds-avatar_circle slds-avatar_medium" href="javascript:void(0);">
                        <lightning:avatar src="{!$Resource.SLDS+'/images/avatar1.jpg'}" initials="BW" fallbackIconName="standard:person_account"
                            alternativeText="{!v.tpUser.TP_Name__c}" />
                    </a>
                </div>
            </aura:if>
            <aura:if isTrue="{!v.tpUser.Gender__c == 'Female'}">
                <div class="slds-media__figure">
                    <a class="slds-avatar slds-avatar_circle slds-avatar_medium" href="javascript:void(0);">
                        <lightning:avatar src="{!$Resource.SLDS+'/images/avatar2.jpg'}" initials="BW"
                            fallbackIconName="standard:person_account" alternativeText="{!v.tpUser.TP_Name__c}" />
                    </a>
                </div>
            </aura:if>
            <div class="slds-media__body">
                <div class="slds-publisher slds-publisher_comment slds-is-active slds-has-focus">
                    <label for="commentinput" class="slds-assistive-text">Write a comment</label>
                    <lightning:textarea aura:id="commentinput" required="true" class="slds-publisher__input slds-input_bare slds-text-longform" 
                        placeholder="Write a comment…" value="{!v.comments}"/>
                    <div class="slds-publisher__actions slds-grid slds-grid_align-spread">
                        <ul class="slds-grid">
                            <li>
                                <lightning:buttonIcon iconName="utility:attach" variant="bare" alternativeText="Attach a file" title="Attach a file">
                                    <span class="slds-assistive-text">Attach a file</span>
                                </lightning:buttonIcon>
                            </li>
                        </ul>
                        <lightning:button variant="brand" label="Comment" title="Comment" onclick="{!c.addComment}" />
                    </div>
                </div>
            </div>
        </div>
    </div> -->
    <hr />
    <div class="slds-col">
        <center><div class="slds-text-heading_medium">Reimbursement</div></center>
    </div>
    <hr />
    <div class="slds-grid slds-wrap">
        <div class="slds-col slds-large-size_1-of-3 slds-medium-size_1-of-2 slds-size_1-of-1">
            <div class="slds-text-heading_small slds-text-align_center">Short Summary of Reimbusrsement Requests</div> <br />
            <aura:if isTrue="{!v.reimbursementFound}">
                <div class="slds-text-align_center">You have to pay the following amount to Trip Members</div> <br /> <hr />
                <aura:iteration items="{!v.reimbursementPaymentsRecords}" var="reimbur">
                    <ul class="slds-has-dividers_around slds-has-block-links_space">
                        <li class="slds-item slds-var-p-vertical_medium slds-var-p-horizontal_medium">
                            <lightning:formattedText value="{!reimbur.Requested_TP_username__c}"></lightning:formattedText>-
                            ₹:<lightning:formattedNumber value="{!reimbur.Amount__c}"></lightning:formattedNumber> <br />
                        </li><br />
                    </ul>
                </aura:iteration>
            </aura:if>
        </div>
        <div class="slds-col slds-large-size_2-of-3 slds-medium-size_1-of-2 slds-size_1-of-1">
            <div class="slds-text-heading_small slds-text-align_center">Fill the below form for claim the Reimbursement</div> <br />
            <div class="slds-var-p-around_medium">
                <lightning:input type="text" aura:id="rename" label="Name" placeholder="Enter the reimbursement name" value="{!v.reimbursement.Reimbursement_name__c}" required="true"></lightning:input>
            </div>
            <div class="slds-var-p-around_medium">
                <lightning:input type="number" aura:id="reamount" name="amount" label="Amount" required="true" placeholder="Ente the amount" formatter="currency" value="{!v.reimbursement.Amount__c}" step="0.01"/>
            </div>
            <div class="slds-var-p-around_medium">
                <lightning:combobox name="retype" aura:id="retype" label="Reimbursement Type " placeholder="Choose Reimbursement Type" value="{!v.reimbursement.Reimbursement_type__c}" options="{!v.options}" required="true" onchange="{!c.showOtherType}" />
            </div>
            <aura:if isTrue="{!v.reOtherType}">
                <div class="slds-var-p-around_medium">
                    <lightning:input type="text" aura:id="retypeother" label="If other, please specify" placeholder="Enter Other type" value="{!v.reimbursement.Other_Type__c}" required="true"></lightning:input>
                </div>
            </aura:if>
            <div class="slds-var-p-around_medium">
                <lightning:textarea name="description" aura:id="redescr" value="{!v.reimbursement.Description__c}" placeholder="Enter the description if any" label="Description" maxlength="140" messageWhenTooLong="A maximum of 140 characters are allowed in a tweet."/>
            </div>
            <div class="slds-var-p-around_medium">
                <!-- <lightning:dualListbox name="requser" aura:id="rerequser" label="Requested to" placeholder="Choose TripPanda user" value="{!v.reimbursement.TripPandaMemberName__c}" options="{!v.tpusers}" required="true" onchange="{!c.addIntoSelectedTpUsers}" /> -->

                <lightning:dualListbox name="requser" aura:id="rerequser" label="Requested to" placeholder="Choose TripPanda user" options="{!v.tpusers}" required="true" sourceLabel="Available" selectedLabel="Selected" onchange="{!c.addIntoSelectedTpUsers}" />
            </div>
            <div class="slds-var-p-around_medium">
                <lightning:button variant="brand" label="Add" title="Add" onclick="{!c.addReimbursement}" />
            </div>
        </div>
    </div>
    <hr />
    <div class="slds-col">
        <center><div class="slds-text-heading_medium">Reimbursement Requested Details</div></center>
    </div>
    <hr />
    
    <aura:if isTrue="{!v.reimbursementFound}">
        <div class="slds-col">
            <table class="slds-table slds-table_cell-buffer slds-table_bordered slds-show_medium tableData">
                <thead>
                    <tr class="slds-line-height_reset">
                        <th class="" scope="col">
                            <div class="slds-truncate" title="Reimbursement Name">Reimbursement Name</div>
                        </th>
                        <th class="" scope="col">
                            <div class="slds-truncate" title="Amount">Amount</div>
                        </th>
                        <th class="" scope="col">
                            <div class="slds-truncate" title="Reimbursement Type">Reimbursement Type</div>
                        </th>
                        <th class="" scope="col">
                            <div class="slds-truncate" title="Other Type">Other Type</div>
                        </th>
                        <th class="" scope="col">
                            <div class="slds-truncate" title="Description">Description</div>
                        </th>
                        <th class="" scope="col">
                            <div class="slds-truncate" title="Requested By">Requested By</div>
                        </th>
                        <th class="" scope="col">
                            <div class="slds-truncate" title="Requested Date">Requested Date</div>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <aura:iteration items="{!v.reimbursementRecords}" var="records">
                        <tr class="slds-hint-parent" key="{records.Id}">
                            <th data-label="Reimbursement Name" scope="row">
                                <div class="slds-truncate" title="{!records.Reimbursement_name__c}">
                                    <a href="javascript:void(0);" tabindex="-1">{!records.Reimbursement_name__c}</a>
                                </div>
                            </th>
                            <td data-label="Amount">
                                <div class="slds-truncate" title="{!records.Amount__c}">
                                    {!records.Amount__c}</div>
                            </td>
                            <td data-label="Reimbursement Type">
                                <div class="slds-truncate" title="{!records.Reimbursement_type__c}">
                                    {!records.Reimbursement_type__c}</div>
                            </td>
                            <td data-label="Other Type">
                                <div class="slds-truncate" title="{!records.Other_Type__c}">
                                    {!records.Other_Type__c}</div>
                            </td>
                            <td data-label="Description">
                                <div class="slds-truncate" title="{!records.Description__c}">{!records.Description__c}</div>
                            </td>
                            <td data-label="Requested By">
                                <div class="slds-truncate" title="{!records.Reimbursement_requested_by__c}">{!records.Reimbursement_requested_by__c}</div>
                            </td>
                            <td data-label="Requested Date">
                                <div class="slds-truncate" title="{!records.CreatedDate}">
                                    <a href="javascript:void(0);" tabindex="-1">{!records.CreatedDate}</a>
                                </div>
                            </td>
                        </tr>
                    </aura:iteration>
                </tbody>
            </table>
            
            <!-- For mobile View -->
            <ul class="slds-has-dividers_around-space slds-hide_medium">
                <aura:iteration items="{!v.reimbursementRecords}" var="records">
                    <li class="slds-item" key="{!records.Id}">
                        <a href="javascript:void(0);">{!records.Reimbursement_name__c}</a>
                        <ul>
                            <li>
                                <div class="slds-list_horizontal">
                                    <div class="slds-item_label slds-truncate recordCell" title="Amount:">Amount:
                                    </div>
                                    <div class="slds-item_detail slds-truncate recordCell">
                                        <span>{!records.Amount__c}</span>
                                    </div>
                                </div>
                            </li>
                            <li>
                                <div class="slds-list_horizontal">
                                    <div class="slds-item_label slds-truncate recordCell" title="Reimbursement Type:">Reimbursement Type:
                                    </div>
                                    <div class="slds-item_detail slds-truncate recordCell">
                                        <span>{!records.Reimbursement_type__c}</span>
                                    </div>
                                </div>
                            </li>
                            <li>
                                <div class="slds-list_horizontal">
                                    <div class="slds-item_label slds-truncate recordCell" title="Other Type:">Other Type:

                                    </div>
                                    <div class="slds-item_detail slds-truncate recordCell">
                                        <span>{!records.Other_Type__c}</span>
                                    </div>
                                </div>
                            </li>
                            <li >
                                <div class="slds-list_horizontal">
                                    <div class="slds-item_label slds-truncate recordCell" title="Description:">
                                        Description:</div>
                                    <div class="slds-item_detail slds-truncate recordCell">
                                        <span>{!records.Description__c}</span>
                                    </div>
                                </div>
                            </li>
                            <li>
                                <div class="slds-list_horizontal">
                                    <div class="slds-item_label slds-truncate recordCell" title="Requested By:">Requested By:
                                    </div>
                                    <div class="slds-item_detail slds-truncate recordCell">
                                        <span>{!records.Reimbursement_requested_by__c}</span>
                                    </div>
                                </div>
                            </li>
                            <li>
                                <div class="slds-list_horizontal">
                                    <div class="slds-item_label slds-truncate recordCell" title="Requested Date:">Requested Date:
                                    </div>
                                    <div class="slds-item_detail slds-truncate recordCell">
                                        <span>{!records.CreatedDate}</span>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </li>
                </aura:iteration>
            </ul>
        </div>
    </aura:if>

    <aura:if isTrue="{!!v.reimbursementFound}">
        <article class="slds-card slds-card_boundary ">
            <div class="slds-card__body slds-card__body_inner">
                <div class="slds-illustration slds-illustration_small" aria-hidden="true">
                    <img src="https://vaasaportal-developer-edition.ap4.force.com/img/chatter/OpenRoad.svg" class="slds-illustration__svg" alt="" />
                    <div class="slds-text-color_weak">
                        <h3 class="slds-text-heading_medium">No Data</h3>
                    </div>
                </div>
            </div>
        </article>
    </aura:if>

    <hr />
    <div class="slds-col">
        <center><div class="slds-text-heading_medium">Reimbursement Raised Details</div></center>
    </div>
    <hr />
    
    <aura:if isTrue="{!v.reimbursementraiseFound}">
        <div class="slds-col">
            <table class="slds-table slds-table_cell-buffer slds-table_bordered slds-show_medium tableData">
                <thead>
                    <tr class="slds-line-height_reset">
                        <th class="" scope="col">
                            <div class="slds-truncate" title="Reimbursement Name">Reimbursement Name</div>
                        </th>
                        <th class="" scope="col">
                            <div class="slds-truncate" title="Amount">Amount</div>
                        </th>
                        <th class="" scope="col">
                            <div class="slds-truncate" title="Reimbursement Type">Reimbursement Type</div>
                        </th>
                        <th class="" scope="col">
                            <div class="slds-truncate" title="Other Type">Other Type</div>
                        </th>
                        <th class="" scope="col">
                            <div class="slds-truncate" title="Description">Description</div>
                        </th>
                        <th class="" scope="col">
                            <div class="slds-truncate" title="Requested By">Requested By</div>
                        </th>
                        <th class="" scope="col">
                            <div class="slds-truncate" title="Requested Date">Requested Date</div>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <aura:iteration items="{!v.reimbursementraiseRecords}" var="records">
                        <tr class="slds-hint-parent" key="{records.Id}">
                            <th data-label="Reimbursement Name" scope="row">
                                <div class="slds-truncate" title="{!records.Reimbursement_name__c}">
                                    <a href="javascript:void(0);" tabindex="-1">{!records.Reimbursement_name__c}</a>
                                </div>
                            </th>
                            <td data-label="Amount">
                                <div class="slds-truncate" title="{!records.Amount__c}">
                                    {!records.Amount__c}</div>
                            </td>
                            <td data-label="Reimbursement Type">
                                <div class="slds-truncate" title="{!records.Reimbursement_type__c}">
                                    {!records.Reimbursement_type__c}</div>
                            </td>
                            <td data-label="Other Type">
                                <div class="slds-truncate" title="{!records.Other_Type__c}">
                                    {!records.Other_Type__c}</div>
                            </td>
                            <td data-label="Description">
                                <div class="slds-truncate" title="{!records.Description__c}">{!records.Description__c}</div>
                            </td>
                            <td data-label="Requested By">
                                <div class="slds-truncate" title="{!records.Reimbursement_requested_by__c}">{!records.Reimbursement_requested_by__c}</div>
                            </td>
                            <td data-label="Requested Date">
                                <div class="slds-truncate" title="{!records.CreatedDate}">
                                    <a href="javascript:void(0);" tabindex="-1">{!records.CreatedDate}</a>
                                </div>
                            </td>
                        </tr>
                    </aura:iteration>
                </tbody>
            </table>
            
            <!-- For mobile View -->
            <ul class="slds-has-dividers_around-space slds-hide_medium">
                <aura:iteration items="{!v.reimbursementraiseRecords}" var="records">
                    <li class="slds-item" key="{!records.Id}">
                        <a href="javascript:void(0);">{!records.Reimbursement_name__c}</a>
                        <ul>
                            <li>
                                <div class="slds-list_horizontal">
                                    <div class="slds-item_label slds-truncate recordCell" title="Amount:">Amount:
                                    </div>
                                    <div class="slds-item_detail slds-truncate recordCell">
                                        <span>{!records.Amount__c}</span>
                                    </div>
                                </div>
                            </li>
                            <li>
                                <div class="slds-list_horizontal">
                                    <div class="slds-item_label slds-truncate recordCell" title="Reimbursement Type:">Reimbursement Type:
                                    </div>
                                    <div class="slds-item_detail slds-truncate recordCell">
                                        <span>{!records.Reimbursement_type__c}</span>
                                    </div>
                                </div>
                            </li>
                            <li>
                                <div class="slds-list_horizontal">
                                    <div class="slds-item_label slds-truncate recordCell" title="Other Type:">Other Type:

                                    </div>
                                    <div class="slds-item_detail slds-truncate recordCell">
                                        <span>{!records.Other_Type__c}</span>
                                    </div>
                                </div>
                            </li>
                            <li >
                                <div class="slds-list_horizontal">
                                    <div class="slds-item_label slds-truncate recordCell" title="Description:">
                                        Description:</div>
                                    <div class="slds-item_detail slds-truncate recordCell">
                                        <span>{!records.Description__c}</span>
                                    </div>
                                </div>
                            </li>
                            <li>
                                <div class="slds-list_horizontal">
                                    <div class="slds-item_label slds-truncate recordCell" title="Requested By:">Requested By:
                                    </div>
                                    <div class="slds-item_detail slds-truncate recordCell">
                                        <span>{!records.Reimbursement_requested_by__c}</span>
                                    </div>
                                </div>
                            </li>
                            <li>
                                <div class="slds-list_horizontal">
                                    <div class="slds-item_label slds-truncate recordCell" title="Requested Date:">Requested Date:
                                    </div>
                                    <div class="slds-item_detail slds-truncate recordCell">
                                        <span>{!records.CreatedDate}</span>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </li>
                </aura:iteration>
            </ul>
        </div>
    </aura:if>

    <aura:if isTrue="{!!v.reimbursementraiseFound}">
        <article class="slds-card slds-card_boundary ">
            <div class="slds-card__body slds-card__body_inner">
                <div class="slds-illustration slds-illustration_small" aria-hidden="true">
                    <img src="https://vaasaportal-developer-edition.ap4.force.com/img/chatter/OpenRoad.svg" class="slds-illustration__svg" alt="" />
                    <div class="slds-text-color_weak">
                        <h3 class="slds-text-heading_medium">No Data</h3>
                    </div>
                </div>
            </div>
        </article>
    </aura:if>
    <hr />
    <div class="slds-col">
        <center><div class="slds-text-heading_medium">Story Timeline about this journey</div></center><br />
        <div class="slds-float_right"><lightning:button variant="brand" label="Add Comment" title="Add Comment" onclick="{!c.addCommentForStoryLine}" /></div>
    </div>
    <br />
    <hr />
    <div class="slds-grid slds-wrap">
        <div class="slds-col slds-large-size_2-of-3 slds-medium-size_1-of-2 slds-size_1-of-1 slds-scrollable_y" style="height: 22rem;">
            <aura:if isTrue="{!v.storyTimelineFound}">
                <aura:iteration items="{!v.storyTimeline}" var="storytime">
                    <div class="slds-feed feedStyle">
                        <ul class="slds-feed__list">
                            <li class="slds-feed__item">
                                <article class="slds-post">
                                    <header class="slds-post__header slds-media">
                                        <aura:if isTrue="{!storytime.TripPandaUser__r.Profile_Image_Url__c != null}">
                                            <div class="slds-media__figure">
                                                <a class="slds-avatar slds-avatar_circle slds-avatar_medium" href="javascript:void(0);">
                                                    <!-- <img alt="Person name" src="/assets/images/avatar2.jpg" title="User avatar" /> -->
                                                    <lightning:avatar src="{!storytime.TripPandaUser__r.Profile_Image_Url__c}" initials="BW"
                                                        fallbackIconName="standard:person_account" alternativeText="{!storytime.TripPandaUser__r.TP_Name__c}" />
                                                </a>
                                            </div>
                                        </aura:if>
                                        <aura:if isTrue="{!and(storytime.TripPandaUser__r.Gender__c == 'Male', storytime.TripPandaUser__r.Profile_Image_Url__c == null)}">
                                            <div class="slds-media__figure">
                                                <a class="slds-avatar slds-avatar_circle slds-avatar_medium" href="javascript:void(0);">
                                                    <!-- <img alt="Person name" src="/assets/images/avatar2.jpg" title="User avatar" /> -->
                                                    <lightning:avatar src="{!$Resource.SLDS+'/images/avatar1.jpg'}" initials="BW"
                                                        fallbackIconName="standard:person_account" alternativeText="{!storytime.TripPandaUser__r.TP_Name__c}" />
                                                </a>
                                            </div>
                                        </aura:if>
                                        <aura:if isTrue="{!and(storytime.TripPandaUser__r.Gender__c == 'Female', storytime.TripPandaUser__r.Profile_Image_Url__c == null)}">
                                            <div class="slds-media__figure">
                                                <a class="slds-avatar slds-avatar_circle slds-avatar_medium" href="javascript:void(0);">
                                                    <!-- <img alt="Person name" src="/assets/images/avatar2.jpg" title="User avatar" /> -->
                                                    <lightning:avatar src="{!$Resource.SLDS+'/images/avatar3.jpg'}" initials="BW"
                                                        fallbackIconName="standard:person_account" alternativeText="{!storytime.TripPandaUser__r.TP_Name__c}" />
                                                </a>
                                            </div>
                                        </aura:if>
                                        <div class="slds-media__body">
                                            <div class="slds-grid slds-grid_align-spread slds-has-flexi-truncate">
                                                <p>
                                                    <a href="javascript:void(0);" title="{!storytime.TripPandaUser__r.TP_Name__c}">{!storytime.TripPandaUser__r.TP_Name__c}</a>
                                                </p>
                                            </div>
                                            <aura:if isTrue="{!storytime.Commented_days__c == 0}">
                                                <p class="slds-text-body_small">
                                                    <a href="javascript:void(0);" title="Click for single-item view of this post"
                                                        class="slds-text-link_reset">Today</a>
                                                </p>
                                            </aura:if>
                                            <aura:if isTrue="{!storytime.Commented_days__c != 0}">
                                                <p class="slds-text-body_small">
                                                    <a href="javascript:void(0);" title="Click for single-item view of this post"
                                                        class="slds-text-link_reset">{!storytime.Commented_days__c} days Ago</a>
                                                </p>
                                            </aura:if>
                                        </div>
                                    </header>
                                    <div class="slds-post__content slds-text-longform">
                                        <p>{!storytime.Comments__c}</p>
                                    </div>
                                    <footer class="slds-post__footer">
                                        <ul class="slds-post__footer-actions-list slds-list_horizontal">
                                            <li class="slds-col slds-item slds-var-m-right_medium">
                                                <lightning:button title="Like this item" value="Like" variant="bare" iconName="utility:like"
                                                    class="slds-button_reset slds-post__footer-action slds-is-active">
                                                    Like
                                                </lightning:button>
                                            </li>
                                            <li class="slds-col slds-item slds-var-m-right_medium">
                                                <lightning:button title="Comment on this item" value="Comment" variant="bare"
                                                    iconName="utility:comments"
                                                    class="slds-button_reset slds-post__footer-action slds-is-active">
                                                    Comment
                                                </lightning:button>
                                            </li>
                                            <li class="slds-col slds-item slds-var-m-right_medium">
                                                <lightning:button title="Share this item" value="Share" variant="bare"
                                                    iconName="utility:share"
                                                    class="slds-button_reset slds-post__footer-action slds-is-active" onclick="{!c.showShareSection}">
                                                    Share
                                                </lightning:button>
                                            </li>
                                        </ul>
                                        <ul
                                            class="slds-post__footer-meta-list slds-list_horizontal slds-has-dividers_right slds-text-title">
                                            <li class="slds-item">20 shares</li>
                                            <li class="slds-item">259 views</li>
                                        </ul>
                                    </footer>
                                </article>
                            </li>
                        </ul>
                    </div>
                </aura:iteration>
                <aura:if isTrue="{!v.sharethis}">
                    <div class="sharethis-inline-share-buttons"></div>
                    <h1>shareThis</h1>
                </aura:if>
            </aura:if>
        </div>
        <aura:if isTrue="{!v.tpConfig.Youtube_URL__c != null}">
            <div class="slds-col slds-large-size_1-of-3 slds-medium-size_1-of-2 slds-size_1-of-1">
                <iframe style="height: 22rem;width: 28rem;" src="{!v.tpConfig.Youtube_URL__c}" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="true"></iframe>
            </div>
        </aura:if>
        <aura:if isTrue="{!v.tpConfig.Youtube_URL__c == null}">
            <div class="slds-col slds-large-size_1-of-3 slds-medium-size_1-of-2 slds-size_1-of-1">
                <img src="{!v.tpConfig.Trip_Image__c}" style="height: 22rem;width: 28rem;" alt="inside view" />
            </div>
        </aura:if>
    </div>
    <aura:if isTrue="{!v.addCommentShow}">
        <section role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open slds-modal_medium" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1">
            <div class="slds-modal__container">
                <header class="slds-modal__header">
                    <lightning:icon class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" iconName="utility:close" alternativeText="Close" title="Close" onclick="{!c.addCommentForStoryLine}" />
                    <h2 id="modal-heading-01" class="slds-modal__title slds-hyphenate">Add Comments to StoryTimeLine</h2>
                </header>
                <div class="slds-modal__content slds-var-p-around_medium" id="modal-content-id-1">
                    <div class="slds-media slds-comment slds-hint-parent">
                        <aura:if isTrue="{!v.tpUser.Profile_Image_Url__c != null}">
                            <span class="slds-avatar slds-avatar_large">
                                <lightning:avatar src="{!v.tpUser.Profile_Image_Url__c}" initials="BW"
                                    fallbackIconName="standard:person_account" alternativeText="{!v.tpUser.TP_Name__c}" />
                            </span>
                        </aura:if>
                        <aura:if isTrue="{!and(v.tpUser.Gender__c == 'Male', v.tpUser.Profile_Image_Url__c == null)}">
                            <span class="slds-avatar slds-avatar_large">
                                <lightning:avatar src="{!$Resource.SLDS+'/images/avatar1.jpg'}" initials="BW"
                                    fallbackIconName="standard:person_account" alternativeText="{!v.tpUser.TP_Name__c}" />
                            </span>
                        </aura:if>
                        <aura:if isTrue="{!and(v.tpUser.Gender__c == 'Female', v.tpUser.Profile_Image_Url__c == null)}">
                            <span class="slds-avatar slds-avatar_large">
                                <lightning:avatar src="{!$Resource.SLDS+'/images/avatar2.jpg'}" initials="BW"
                                    fallbackIconName="standard:person_account" alternativeText="{!v.tpUser.TP_Name__c}" />
                            </span>
                        </aura:if>
                        <div class="slds-media__body">
                            <div class="slds-publisher slds-publisher_comment slds-is-active slds-has-focus">
                                <label for="commentinput" class="slds-assistive-text">Write a comment</label>
                                <lightning:textarea aura:id="commentinput" required="true"
                                    class="slds-publisher__input slds-input_bare slds-text-longform" placeholder="Write a comment…"
                                    value="{!v.comments}"  messageWhenValueMissing="An empty comment cannot be posted." />
                                <div class="slds-publisher__actions slds-grid slds-grid_align-spread">
                                    <ul class="slds-grid">
                                        <li>
                                            <lightning:buttonIcon iconName="utility:attach" variant="bare" alternativeText="Attach a file"
                                                title="Attach a file">
                                                <span class="slds-assistive-text">Attach a file</span>
                                            </lightning:buttonIcon>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <footer class="slds-modal__footer">
                <button class="slds-button slds-button_neutral" onclick="{!c.addCommentForStoryLine}">Cancel</button>
                <lightning:button variant="brand" label="Comment" title="Comment" onclick="{!c.addComment}" />
                </footer>
            </div>
        </section>
        <div class="slds-backdrop slds-backdrop_open"></div>
    </aura:if>
    <aura:if isTrue="{!v.sharethis}">
        <div class="sharethis-inline-share-buttons"></div>
        <h1>shareThis</h1>
    </aura:if>
</aura:component>